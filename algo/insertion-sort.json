{
  "id": "insertion-sort",
  "title": "Insertion sort",
  "pattern": "sorting",
  "difficulty": "easy",
  "language": "javascript",
  "status": "draft",
  "flow": [
    {
      "stepId": "objectives",
      "mentorSays": "Hey! Welcome to the Insertion sort lesson.\n\nIn this lesson, you'll learn a problem-solving pattern that shows up in coding interviews.\n\nAfter this, you'll be able to:\n- Understand the Insertion sort problem\n- Recognize the sorting pattern\n- Build a complete solution step-by-step\n\nLet's dive in!",
      "action": "continue",
      "next": "language-selection"
    },
    {
      "stepId": "language-selection",
      "mentorSays": "Before we dive into the problem, which programming language would you like to use?\n\nThis will help me make sure you have the right building blocks.",
      "choices": [
        {
          "label": "JavaScript",
          "next": "prereq-check-js"
        },
        {
          "label": "Python",
          "next": "prereq-check-python"
        },
        {
          "label": "Java",
          "next": "prereq-check-java"
        },
        {
          "label": "C++",
          "next": "prereq-check-cpp"
        },
        {
          "label": "TypeScript",
          "next": "prereq-check-ts"
        }
      ]
    },
    {
      "stepId": "prereq-check-js",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in JavaScript, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-js"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-js"
        }
      ]
    },
    {
      "stepId": "prereq-check-python",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in Python, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-python"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-python"
        }
      ]
    },
    {
      "stepId": "prereq-check-java",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in Java, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-java"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-java"
        }
      ]
    },
    {
      "stepId": "prereq-check-cpp",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in C++, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-cpp"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-cpp"
        }
      ]
    },
    {
      "stepId": "prereq-check-ts",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in TypeScript, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-ts"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-ts"
        }
      ]
    },
    {
      "stepId": "teach-all-prereqs-js",
      "mentorSays": "Let me explain the JavaScript concepts you'll need.\n\n[Prerequisite teaching will be expanded in Phase 2]\n\nFor now, let's continue to the problem!",
      "action": "continue",
      "next": "problem-understanding"
    },
    {
      "stepId": "teach-all-prereqs-python",
      "mentorSays": "Let me explain the Python concepts you'll need.\n\n[Prerequisite teaching will be expanded in Phase 2]\n\nFor now, let's continue to the problem!",
      "action": "continue",
      "next": "problem-understanding"
    },
    {
      "stepId": "teach-all-prereqs-java",
      "mentorSays": "Let me explain the Java concepts you'll need.\n\n[Prerequisite teaching will be expanded in Phase 2]\n\nFor now, let's continue to the problem!",
      "action": "continue",
      "next": "problem-understanding"
    },
    {
      "stepId": "teach-all-prereqs-cpp",
      "mentorSays": "Let me explain the C++ concepts you'll need.\n\n[Prerequisite teaching will be expanded in Phase 2]\n\nFor now, let's continue to the problem!",
      "action": "continue",
      "next": "problem-understanding"
    },
    {
      "stepId": "teach-all-prereqs-ts",
      "mentorSays": "Let me explain the TypeScript concepts you'll need.\n\n[Prerequisite teaching will be expanded in Phase 2]\n\nFor now, let's continue to the problem!",
      "action": "continue",
      "next": "problem-understanding"
    },
    {
      "stepId": "problem-understanding",
      "mentorSays": "At the end of this lesson, you will be able to:\n\n1. Understand how insertion sort works\n2. Insert each element into its correct position in the sorted portion\n3. Shift elements to make room for insertion\n4. Implement insertion sort step by step in your chosen language",
      "example": null,
      "action": "continue",
      "next": "approach-exploration"
    },
    {
      "stepId": "thinking-challenge",
      "mentorSays": "Now that you understand the problem, how would YOU approach solving it?\n\nThink about it for a moment.",
      "choices": [
        {
          "label": "Check every possibility",
          "next": "explore-brute-force"
        },
        {
          "label": "Use a smarter approach",
          "next": "explore-optimal"
        },
        {
          "label": "I'm not sure, show me",
          "next": "explore-optimal"
        }
      ]
    },
    {
      "stepId": "explore-solution",
      "mentorSays": "Let me show you the optimal approach for this problem. [Strategy will be extracted from original lesson]",
      "action": "continue",
      "next": "solution-finalized"
    },
    {
      "stepId": "explore-nested-loops",
      "mentorSays": "Excellent choice! The nested loops approach is the standard way to implement insertion sort. Here's the core idea:\n\n1. **Outer loop**: Iterate through each element starting from index 1 (first element is already sorted).\n2. **Store current element**: Save the element we're inserting (it might get overwritten during shifting).\n3. **Inner loop**: Move backwards through the sorted portion, shifting elements right until we find the correct position.\n4. **Insert**: Place the stored element in its correct position.\n\nLet's trace this with [5, 2, 8, 1, 9]:\n\n- **Iteration 1** (i=1, element=2):\n  - Store: key = 2\n  - j = 0: Compare 2 with arr[0]=5, 2 < 5, shift 5 right â†’ [5, 5, 8, 1, 9]\n  - j = -1: Stop, insert key at index 0 â†’ [2, 5, 8, 1, 9]\n\n- **Iteration 2** (i=2, element=8):\n  - Store: key = 8\n  - j = 1: Compare 8 with arr[1]=5, 8 > 5, stop\n  - Insert key at index 2 (already in place) â†’ [2, 5, 8, 1, 9]\n\n- **Iteration 3** (i=3, element=1):\n  - Store: key = 1\n  - j = 2: Compare 1 with arr[2]=8, 1 < 8, shift 8 right â†’ [2, 5, 8, 8, 9]\n  - j = 1: Compare 1 with arr[1]=5, 1 < 5, shift 5 right â†’ [2, 5, 5, 8, 9]\n  - j = 0: Compare 1 with arr[0]=2, 1 < 2, shift 2 right â†’ [2, 2, 5, 8, 9]\n  - j = -1: Stop, insert key at index 0 â†’ [1, 2, 5, 8, 9]\n\n- **Iteration 4** (i=4, element=9):\n  - Store: key = 9\n  - j = 3: Compare 9 with arr[3]=8, 9 > 8, stop\n  - Insert key at index 4 (already in place) â†’ [1, 2, 5, 8, 9]\n\nThis is O(nÂ²) time complexity in worst case, but O(n) for nearly sorted arrays! Now let's code it step by step.",
      "example": "",
      "action": "continue",
      "next": "language-selection"
    },
    {
      "stepId": "approach-exploration",
      "mentorSays": "Now that you understand the problem, let's think about how to solve it.\n\nWhat approach feels natural to you?",
      "choices": [
        {
          "label": "Try the straightforward approach first",
          "next": "explore-solution"
        },
        {
          "label": "Show me the optimal solution",
          "next": "explore-solution"
        }
      ]
    },
    {
      "stepId": "explore-brute-force",
      "mentorSays": "The brute force approach would check every possibility.\n\nThis works but is usually slow (O(n squared) or worse).\n\nLet's look at a smarter approach!",
      "action": "continue",
      "next": "explore-optimal"
    },
    {
      "stepId": "explore-optimal",
      "mentorSays": "The optimal approach uses a smarter strategy to avoid unnecessary work.\n\n[Strategy details will be added in Phase 2]",
      "action": "continue",
      "next": "solution-finalized"
    },
    {
      "stepId": "solution-finalized",
      "mentorSays": "Perfect! We've explored the approach. Now let's code the optimal solution.\n\nReady to write some code?",
      "action": "continue",
      "next": "coding-start-js"
    },
    {
      "stepId": "coding-start-js",
      "mentorSays": "Perfect! Let's implement insertion sort in JavaScript. We'll create a function that takes an array and sorts it in-place by inserting each element into its correct position.",
      "example": "function insertionSort(arr) {\n  // Your code here\n}",
      "action": "continue",
      "next": "coding-outer-loop-js"
    },
    {
      "stepId": "coding-outer-loop-js",
      "mentorSays": "First, let's create the outer loop. This loop starts from index 1 (the first element is already sorted) and goes through each element.",
      "example": "function insertionSort(arr) {\n  const n = arr.length;\n  \n  // Outer loop: start from index 1\n  for (let i = 1; i < n; i++) {\n    // Each iteration inserts arr[i] into the sorted portion\n  }\n}",
      "action": "continue",
      "next": "coding-store-key-js"
    },
    {
      "stepId": "coding-store-key-js",
      "mentorSays": "Store the current element in a variable called 'key'. We'll need it later because elements might shift and overwrite it.",
      "example": "function insertionSort(arr) {\n  const n = arr.length;\n  \n  for (let i = 1; i < n; i++) {\n    // Store the element we're inserting\n    const key = arr[i];\n    // Now find where to insert it\n  }\n}",
      "action": "continue",
      "next": "coding-inner-loop-js"
    },
    {
      "stepId": "coding-inner-loop-js",
      "mentorSays": "Now, let's create the inner loop. This loop moves backwards through the sorted portion (from i-1 to 0), shifting elements right until we find the correct position for key.",
      "example": "function insertionSort(arr) {\n  const n = arr.length;\n  \n  for (let i = 1; i < n; i++) {\n    const key = arr[i];\n    let j = i - 1;\n    \n    // Inner loop: shift elements right while key is smaller\n    while (j >= 0 && arr[j] > key) {\n      arr[j + 1] = arr[j];\n      j--;\n    }\n  }\n}",
      "action": "continue",
      "next": "coding-insert-js"
    },
    {
      "stepId": "coding-insert-js",
      "mentorSays": "Finally, insert the key at position j+1. This is the correct position where all elements to the left are smaller than key.",
      "example": "function insertionSort(arr) {\n  const n = arr.length;\n  \n  for (let i = 1; i < n; i++) {\n    const key = arr[i];\n    let j = i - 1;\n    \n    // Shift elements right while key is smaller\n    while (j >= 0 && arr[j] > key) {\n      arr[j + 1] = arr[j];\n      j--;\n    }\n    \n    // Insert key at the correct position\n    arr[j + 1] = key;\n  }\n}",
      "action": "continue",
      "next": "completion"
    },
    {
      "stepId": "completion",
      "mentorSays": "ðŸŽ‰ **Congratulations!** You just solved Insertion sort!\n\n**What you've mastered:**\nâœ“ Understanding the problem requirements\nâœ“ Choosing an efficient approach\nâœ“ Building a complete solution from scratch\n\nYou're now ready to tackle more algorithms. Keep going! ðŸš€",
      "action": "complete"
    }
  ],
  "migrated": true,
  "migration_version": "5.0-light-touch",
  "migration_date": "2025-12-30"
}