{
  "id": "heap-sort",
  "title": "Heap sort",
  "pattern": "sorting",
  "difficulty": "hard",
  "language": "javascript",
  "status": "draft",
  "flow": [
    {
      "stepId": "title",
      "mentorSays": "At the end of this lesson, you will be able to:\n\n1. Understand how heap sort works using a binary heap\n2. Build a max heap from an array\n3. Extract maximum elements and maintain heap property\n4. Implement heap sort step by step in your chosen language",
      "action": "continue",
      "next": "problem-illustration"
    },
    {
      "stepId": "problem-illustration",
      "mentorSays": "Perfect! Now let's understand what Heap Sort does.\n\nImagine you have an unsorted array: [5, 2, 8, 1, 9, 3]\n\nYour task: Sort it in ascending order (smallest to largest).\n\nHeap sort uses a binary heap data structure:\n1. **Build Max Heap**: Convert the array into a max heap (parent >= children)\n2. **Extract Maximum**: Repeatedly extract the maximum element (root) and place it at the end\n3. **Heapify**: After each extraction, restore the heap property\n\nLet's trace through the algorithm:\n\n**Initial**: [5, 2, 8, 1, 9, 3]\n\n**Step 1: Build Max Heap**\n- Start from the last parent node and heapify upwards\n- Heap structure: [9, 5, 8, 1, 2, 3]\n  - 9 is root (max)\n  - 5 and 8 are children of 9\n  - 1, 2 are children of 5\n  - 3 is child of 8\n\n**Step 2: Extract and Sort**\n- Extract 9 (max), swap with last element â†’ [3, 5, 8, 1, 2, 9]\n- Heapify: [8, 5, 3, 1, 2, 9]\n- Extract 8, swap with second last â†’ [2, 5, 3, 1, 8, 9]\n- Heapify: [5, 2, 3, 1, 8, 9]\n- Extract 5, swap â†’ [1, 2, 3, 5, 8, 9]\n- Heapify: [3, 2, 1, 5, 8, 9]\n- Extract 3, swap â†’ [1, 2, 3, 5, 8, 9]\n- Continue until sorted\n\n**Final**: [1, 2, 3, 5, 8, 9] (sorted!)\n\nThe key insight: a max heap always has the largest element at the root!",
      "example": "nums = [5, 2, 8, 1, 9, 3]\n\nBuild max heap: [9, 5, 8, 1, 2, 3]\n\nExtract 9 â†’ [3, 5, 8, 1, 2, 9]\nHeapify â†’ [8, 5, 3, 1, 2, 9]\nExtract 8 â†’ [2, 5, 3, 1, 8, 9]\nHeapify â†’ [5, 2, 3, 1, 8, 9]\nExtract 5 â†’ [1, 2, 3, 5, 8, 9]\n...\n\nFinal: [1, 2, 3, 5, 8, 9]",
      "action": "continue",
      "next": "thinking-challenge"
    },
    {
      "stepId": "thinking-challenge",
      "mentorSays": "Now that you understand what heap sort does, here's the real question:\n\nHow would YOU implement heap sort?\n\nThink about it for a moment. What approach feels natural to you?",
      "choices": [
        {
          "label": "Build max heap, then extract maximums one by one",
          "next": "explore-heap-approach"
        },
        {
          "label": "Use a priority queue or built-in heap",
          "next": "explore-priority-queue"
        },
        {
          "label": "Use a different sorting approach",
          "next": "explore-heap-approach"
        }
      ]
    },
    {
      "stepId": "explore-priority-queue",
      "mentorSays": "Using a built-in priority queue is simpler, but it requires extra space. The in-place heap sort is more efficient and doesn't need extra memory.\n\nLet's learn the standard in-place heap sort approach, which is the most common implementation.",
      "action": "continue",
      "next": "explore-heap-approach"
    },
    {
      "stepId": "explore-heap-approach",
      "mentorSays": "Excellent choice! The heap approach is the standard way to implement heap sort. Here's the core idea:\n\n1. **Build Max Heap**: Convert the array into a max heap by heapifying from the last parent node upwards.\n2. **Extract and Sort**: Repeatedly:\n   - Swap the root (maximum) with the last unsorted element\n   - Reduce heap size by 1\n   - Heapify the root to restore heap property\n3. **Heapify Function**: Maintains heap property by comparing parent with children and swapping if needed.\n\nLet's trace this with [5, 2, 8, 1, 9, 3]:\n\n- **Build Heap**:\n  - Start from parent at index 2 (last parent)\n  - Heapify index 2: [5, 2, 8, 1, 9, 3] (8 is already max)\n  - Heapify index 1: [5, 9, 8, 1, 2, 3] (swap 2 and 9)\n  - Heapify index 0: [9, 5, 8, 1, 2, 3] (swap 5 and 9)\n\n- **Extract Maximums**:\n  - Extract 9: swap with 3 â†’ [3, 5, 8, 1, 2, 9], heapify â†’ [8, 5, 3, 1, 2, 9]\n  - Extract 8: swap with 2 â†’ [2, 5, 3, 1, 8, 9], heapify â†’ [5, 2, 3, 1, 8, 9]\n  - Continue until sorted\n\nThe heapify function is key: it maintains the heap property by \"sinking\" a node down to its correct position.\n\nThis is O(n log n) time complexity in all cases - guaranteed performance! Now let's code it step by step.",
      "action": "continue",
      "next": "language-selection"
    },
    {
      "stepId": "language-selection",
      "mentorSays": "Great! Now let's code this solution. Which programming language would you like to use?",
      "choices": [
        {
          "label": "JavaScript",
          "next": "main-variables-check-js"
        },
        {
          "label": "Python",
          "next": "main-variables-check-python"
        },
        {
          "label": "Java",
          "next": "main-variables-check-java"
        },
        {
          "label": "C++",
          "next": "main-variables-check-cpp"
        },
        {
          "label": "TypeScript",
          "next": "main-variables-check-ts"
        }
      ]
    },
    {
      "stepId": "main-variables-check-js",
      "mentorSays": "Before we start coding, let me ask: Do you know what a variable is in JavaScript?",
      "choices": [
        {
          "label": "Yes, I know variables",
          "next": "coding-start-js"
        },
        {
          "label": "No, explain variables",
          "next": "main-variables-explanation-js"
        }
      ]
    },
    {
      "stepId": "main-variables-explanation-js",
      "mentorSays": "A variable is like a labeled box where you can store a value. You give it a name (like 'arr' or 'numbers') and put data inside it.\n\nFor example, in JavaScript, you can create a variable that stores an array. Later, you can use that variable name to refer to the array.",
      "example": "numbers = [3, 7, 2, 9, 5]\n\nNow the variable refers to the array\nWe can use the variable name to access this array",
      "action": "continue",
      "next": "main-function-check-js"
    },
    {
      "stepId": "main-functions-check-js",
      "mentorSays": "Before we start coding, let me ask: Do you know what a function is in JavaScript?",
      "choices": [
        {
          "label": "Yes, I know functions",
          "next": "coding-start-js"
        },
        {
          "label": "No, explain functions",
          "next": "main-functions-explanation-js"
        }
      ]
    },
    {
      "stepId": "main-functions-explanation-js",
      "mentorSays": "A function is a reusable block of code. You give it inputs (called parameters), and it can return an output.\n\nThink of it like a recipe: you provide ingredients (parameters), the function does the work, and gives you a result (return value).",
      "example": "function add(a, b) {\n  return a + b;\n}\n\nadd(3, 5) returns 8",
      "action": "continue",
      "next": "main-parameter-check-js"
    },
    {
      "stepId": "main-parameters-check-js",
      "mentorSays": "When we write a function, we can give it inputs. These inputs are called 'parameters'. Do you know what parameters are?",
      "choices": [
        {
          "label": "Yes, I know parameters",
          "next": "coding-start-js"
        },
        {
          "label": "No, explain parameters",
          "next": "main-parameters-explanation-js"
        }
      ]
    },
    {
      "stepId": "main-parameters-explanation-js",
      "mentorSays": "Parameters are like variables that receive values when you call the function. When you write 'function findMax(arr)', the 'arr' is a parameter - it's a placeholder that will receive an actual array when you call the function.\n\nWhen you call 'findMax([3, 7, 2, 9, 5])', the array [3, 7, 2, 9, 5] gets passed into the function and stored in the 'arr' parameter. Inside the function, you can use 'arr' to refer to that array.",
      "example": "function findMax(arr) {\n  // 'arr' is a parameter\n}\n\nfindMax([3, 7, 2, 9, 5]);\n// The array goes into 'arr'",
      "action": "continue",
      "next": "main-loop-check-js"
    },
    {
      "stepId": "main-loops-check-js",
      "mentorSays": "To solve this, we'll need to use a loop. Do you know what a loop is in JavaScript?",
      "choices": [
        {
          "label": "Yes, I know loops",
          "next": "coding-start-js"
        },
        {
          "label": "No, explain loops",
          "next": "main-loops-explanation-js"
        }
      ]
    },
    {
      "stepId": "main-loops-explanation-js",
      "mentorSays": "For heap sort, we'll use loops to build the heap and extract elements. We'll also need to understand array indexing for the heap structure.\n\nIn a heap represented as an array, for a node at index i:\n- Left child is at index 2*i + 1\n- Right child is at index 2*i + 2\n- Parent is at index Math.floor((i-1)/2)",
      "example": "Array: [9, 5, 8, 1, 2, 3]\nHeap structure:\n    9 (index 0)\n   / \\\n  5   8 (indices 1, 2)\n / \\ /\n1  2 3 (indices 3, 4, 5)",
      "action": "continue",
      "next": "coding-start-js"
    },
    {
      "stepId": "coding-start-js",
      "mentorSays": "Perfect! Let's implement heap sort in JavaScript. We'll need three functions:\n1. `heapSort` - the main function\n2. `buildHeap` - builds a max heap from the array\n3. `heapify` - maintains heap property by sinking a node down\n\nLet's start with the heapSort function.",
      "example": "function heapSort(arr) {\n  // Your code here\n}\n\nfunction buildHeap(arr, n) {\n  // Build max heap\n}\n\nfunction heapify(arr, n, i) {\n  // Maintain heap property\n}",
      "action": "continue",
      "next": "coding-build-heap-js"
    },
    {
      "stepId": "coding-build-heap-js",
      "mentorSays": "First, let's build a max heap. Start from the last parent node (at index Math.floor(n/2) - 1) and heapify upwards.",
      "example": "function heapSort(arr) {\n  const n = arr.length;\n  \n  // Build max heap\n  buildHeap(arr, n);\n}",
      "action": "continue",
      "next": "coding-extract-loop-js"
    },
    {
      "stepId": "coding-extract-loop-js",
      "mentorSays": "Now, extract the maximum element (root) one by one. Swap root with the last element, reduce heap size, and heapify the root.",
      "example": "function heapSort(arr) {\n  const n = arr.length;\n  \n  buildHeap(arr, n);\n  \n  // Extract elements one by one\n  for (let i = n - 1; i > 0; i--) {\n    // Swap root with last element\n    [arr[0], arr[i]] = [arr[i], arr[0]];\n    // Heapify root with reduced heap size\n    heapify(arr, i, 0);\n  }\n}",
      "action": "continue",
      "next": "coding-build-heap-impl-js"
    },
    {
      "stepId": "coding-build-heap-impl-js",
      "mentorSays": "Now let's implement buildHeap. Start from the last parent and heapify each node upwards.",
      "example": "function buildHeap(arr, n) {\n  // Start from last parent node\n  for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {\n    heapify(arr, n, i);\n  }\n}",
      "action": "continue",
      "next": "coding-heapify-start-js"
    },
    {
      "stepId": "coding-heapify-start-js",
      "mentorSays": "Now let's implement the heapify function. This maintains the max heap property by comparing a node with its children and swapping if needed.",
      "example": "function heapify(arr, n, i) {\n  // Your code here\n}",
      "action": "continue",
      "next": "coding-heapify-find-children-js"
    },
    {
      "stepId": "coding-heapify-find-children-js",
      "mentorSays": "Find the indices of the left and right children of node i.",
      "example": "function heapify(arr, n, i) {\n  let largest = i;  // Initialize largest as root\n  const left = 2 * i + 1;  // Left child\n  const right = 2 * i + 2;  // Right child\n}",
      "action": "continue",
      "next": "coding-heapify-compare-js"
    },
    {
      "stepId": "coding-heapify-compare-js",
      "mentorSays": "Compare the root with left and right children. If a child is larger, mark it as the largest.",
      "example": "function heapify(arr, n, i) {\n  let largest = i;\n  const left = 2 * i + 1;\n  const right = 2 * i + 2;\n  \n  // Compare with left child\n  if (left < n && arr[left] > arr[largest]) {\n    largest = left;\n  }\n  \n  // Compare with right child\n  if (right < n && arr[right] > arr[largest]) {\n    largest = right;\n  }\n}",
      "action": "continue",
      "next": "coding-heapify-swap-js"
    },
    {
      "stepId": "coding-heapify-swap-js",
      "mentorSays": "If the largest is not the root, swap and recursively heapify the affected subtree.",
      "example": "function heapify(arr, n, i) {\n  let largest = i;\n  const left = 2 * i + 1;\n  const right = 2 * i + 2;\n  \n  if (left < n && arr[left] > arr[largest]) {\n    largest = left;\n  }\n  \n  if (right < n && arr[right] > arr[largest]) {\n    largest = right;\n  }\n  \n  // If largest is not root, swap and heapify\n  if (largest !== i) {\n    [arr[i], arr[largest]] = [arr[largest], arr[i]];\n    heapify(arr, n, largest);\n  }\n}",
      "action": "continue",
      "next": "test-code-js"
    },
    {
      "stepId": "test-code-js",
      "mentorSays": "Perfect! Now test your code with the example we used earlier:\n\narr = [5, 2, 8, 1, 9, 3]\n\nAfter calling heapSort(arr), the array should be:\n[1, 2, 3, 5, 8, 9]\n\nTry it in your IDE or code editor!",
      "example": "Test input:\narr = [5, 2, 8, 1, 9, 3]\n\nAfter heapSort(arr):\narr = [1, 2, 3, 5, 8, 9]\n\nAll elements are sorted in ascending order.",
      "action": "continue",
      "next": "final"
    },
    {
      "stepId": "main-variables-check-python",
      "mentorSays": "Before we start coding, let me ask: Do you know what a variable is in Python?",
      "choices": [
        {
          "label": "Yes, I know variables",
          "next": "coding-start-python"
        },
        {
          "label": "No, explain variables",
          "next": "main-variables-explanation-python"
        }
      ]
    },
    {
      "stepId": "main-variables-explanation-python",
      "mentorSays": "A variable is like a labeled box where you can store a value. You give it a name (like 'arr' or 'numbers') and put data inside it.\n\nFor example, in Python, you can create a variable that stores an array. Later, you can use that variable name to refer to the array.",
      "example": "numbers = [3, 7, 2, 9, 5]\n\nNow the variable refers to the array\nWe can use the variable name to access this array",
      "action": "continue",
      "next": "main-function-check-python"
    },
    {
      "stepId": "main-functions-check-python",
      "mentorSays": "Before we start coding, let me ask: Do you know what a function is in Python?",
      "choices": [
        {
          "label": "Yes, I know functions",
          "next": "coding-start-python"
        },
        {
          "label": "No, explain functions",
          "next": "main-functions-explanation-python"
        }
      ]
    },
    {
      "stepId": "main-functions-explanation-python",
      "mentorSays": "A function is a reusable block of code. You give it inputs (called parameters), and it can return an output.\n\nThink of it like a recipe: you provide ingredients (parameters), the function does the work, and gives you a result (return value).",
      "example": "function add(a, b) {\n  return a + b;\n}\n\nadd(3, 5) returns 8",
      "action": "continue",
      "next": "main-parameter-check-python"
    },
    {
      "stepId": "main-parameters-check-python",
      "mentorSays": "When we write a function, we can give it inputs. These inputs are called 'parameters'. Do you know what parameters are?",
      "choices": [
        {
          "label": "Yes, I know parameters",
          "next": "coding-start-python"
        },
        {
          "label": "No, explain parameters",
          "next": "main-parameters-explanation-python"
        }
      ]
    },
    {
      "stepId": "main-parameters-explanation-python",
      "mentorSays": "Parameters are like variables that receive values when you call the function. When you write 'function findMax(arr)', the 'arr' is a parameter - it's a placeholder that will receive an actual array when you call the function.\n\nWhen you call 'findMax([3, 7, 2, 9, 5])', the array [3, 7, 2, 9, 5] gets passed into the function and stored in the 'arr' parameter. Inside the function, you can use 'arr' to refer to that array.",
      "example": "function findMax(arr) {\n  // 'arr' is a parameter\n}\n\nfindMax([3, 7, 2, 9, 5]);\n// The array goes into 'arr'",
      "action": "continue",
      "next": "main-loop-check-python"
    },
    {
      "stepId": "main-loops-check-python",
      "mentorSays": "To solve this, we'll need to use a loop. Do you know what a loop is in Python?",
      "choices": [
        {
          "label": "Yes, I know loops",
          "next": "coding-start-python"
        },
        {
          "label": "No, explain loops",
          "next": "main-loops-explanation-python"
        }
      ]
    },
    {
      "stepId": "main-loops-explanation-python",
      "mentorSays": "A loop lets you repeat code multiple times. A 'for' loop in Python runs code for each item in a sequence.\n\nFor example, you can loop through an array to check each element one by one.",
      "example": "for (let i = 0; i < arr.length; i++) {\n  // Process arr[i]\n}",
      "action": "continue",
      "next": "coding-start-python"
    },
    {
      "stepId": "coding-start-python",
      "mentorSays": "Perfect! Let's implement heap sort in Python. We'll need three functions:\n1. `heapSort` - the main function\n2. `buildHeap` - builds a max heap from the array\n3. `heapify` - maintains heap property\n\nLet's start with the heapSort function.",
      "example": "def heap_sort(arr):\n    # Your code here\npass",
      "action": "continue",
      "next": "coding-build-heap-python"
    },
    {
      "stepId": "coding-build-heap-python",
      "mentorSays": "First, let's build a max heap. Start from the last parent node and heapify upwards.",
      "example": "def heap_sort(arr):\n    n = len(arr)\n    \n    # Build max heap\n    build_heap(arr, n)",
      "action": "continue",
      "next": "coding-extract-loop-python"
    },
    {
      "stepId": "coding-extract-loop-python",
      "mentorSays": "Now, extract the maximum element one by one. Swap root with the last element, reduce heap size, and heapify the root.",
      "example": "def heap_sort(arr):\n    n = len(arr)\n    build_heap(arr, n)\n    \n    # Extract elements one by one\n    for i in range(n - 1, 0, -1):\n        arr[0], arr[i] = arr[i], arr[0]\n        heapify(arr, i, 0)",
      "action": "continue",
      "next": "coding-build-heap-impl-python"
    },
    {
      "stepId": "coding-build-heap-impl-python",
      "mentorSays": "Now let's implement buildHeap. Start from the last parent and heapify each node upwards.",
      "example": "def build_heap(arr, n):\n    # Start from last parent node\n    for i in range(n // 2 - 1, -1, -1):\n        heapify(arr, n, i)",
      "action": "continue",
      "next": "coding-heapify-start-python"
    },
    {
      "stepId": "coding-heapify-start-python",
      "mentorSays": "Now let's implement the heapify function. This maintains the max heap property.",
      "example": "def heapify(arr, n, i):\n    # Your code here\npass",
      "action": "continue",
      "next": "coding-heapify-find-children-python"
    },
    {
      "stepId": "coding-heapify-find-children-python",
      "mentorSays": "Find the indices of the left and right children of node i.",
      "example": "def heapify(arr, n, i):\n    largest = i  # Initialize largest as root\n    left = 2 * i + 1  # Left child\n    right = 2 * i + 2  # Right child",
      "action": "continue",
      "next": "coding-heapify-compare-python"
    },
    {
      "stepId": "coding-heapify-compare-python",
      "mentorSays": "Compare the root with left and right children. If a child is larger, mark it as the largest.",
      "example": "def heapify(arr, n, i):\n    largest = i\n    left = 2 * i + 1\n    right = 2 * i + 2\n    \n    # Compare with left child\n    if left < n and arr[left] > arr[largest]:\n        largest = left\n    \n    # Compare with right child\n    if right < n and arr[right] > arr[largest]:\n        largest = right",
      "action": "continue",
      "next": "coding-heapify-swap-python"
    },
    {
      "stepId": "coding-heapify-swap-python",
      "mentorSays": "If the largest is not the root, swap and recursively heapify the affected subtree.",
      "example": "def heapify(arr, n, i):\n    largest = i\n    left = 2 * i + 1\n    right = 2 * i + 2\n    \n    if left < n and arr[left] > arr[largest]:\n        largest = left\n    \n    if right < n and arr[right] > arr[largest]:\n        largest = right\n    \n    # If largest is not root, swap and heapify\n    if largest != i:\n        arr[i], arr[largest] = arr[largest], arr[i]\n        heapify(arr, n, largest)",
      "action": "continue",
      "next": "test-code-python"
    },
    {
      "stepId": "test-code-python",
      "mentorSays": "Perfect! Now test your code with the example we used earlier:\n\narr = [5, 2, 8, 1, 9, 3]\n\nAfter calling heap_sort(arr), the array should be:\n[1, 2, 3, 5, 8, 9]\n\nTry it in your IDE or code editor!",
      "example": "Test input:\narr = [5, 2, 8, 1, 9, 3]\n\nAfter heap_sort(arr):\narr = [1, 2, 3, 5, 8, 9]",
      "action": "continue",
      "next": "final"
    },
    {
      "stepId": "main-variables-check-java",
      "mentorSays": "Before we start coding, let me ask: Do you know what a variable is in Java?",
      "choices": [
        {
          "label": "Yes, I know variables",
          "next": "coding-start-java"
        },
        {
          "label": "No, explain variables",
          "next": "main-variables-explanation-java"
        }
      ]
    },
    {
      "stepId": "main-variables-explanation-java",
      "mentorSays": "A variable is like a labeled box where you can store a value. You give it a name (like 'arr' or 'numbers') and put data inside it.\n\nFor example, in Java, you can create a variable that stores an array. Later, you can use that variable name to refer to the array.",
      "example": "numbers = [3, 7, 2, 9, 5]\n\nNow the variable refers to the array\nWe can use the variable name to access this array",
      "action": "continue",
      "next": "main-function-check-java"
    },
    {
      "stepId": "main-functions-check-java",
      "mentorSays": "Before we start coding, let me ask: Do you know what a method is in Java?",
      "choices": [
        {
          "label": "Yes, I know functions",
          "next": "coding-start-java"
        },
        {
          "label": "No, explain functions",
          "next": "main-functions-explanation-java"
        }
      ]
    },
    {
      "stepId": "main-functions-explanation-java",
      "mentorSays": "A method is a reusable block of code. You give it inputs (called parameters), and it can return an output.\n\nThink of it like a recipe: you provide ingredients (parameters), the method does the work, and gives you a result (return value).",
      "example": "function add(a, b) {\n  return a + b;\n}\n\nadd(3, 5) returns 8",
      "action": "continue",
      "next": "main-parameter-check-java"
    },
    {
      "stepId": "main-parameters-check-java",
      "mentorSays": "When we write a function, we can give it inputs. These inputs are called 'parameters'. Do you know what parameters are?",
      "choices": [
        {
          "label": "Yes, I know parameters",
          "next": "coding-start-java"
        },
        {
          "label": "No, explain parameters",
          "next": "main-parameters-explanation-java"
        }
      ]
    },
    {
      "stepId": "main-parameters-explanation-java",
      "mentorSays": "Parameters are like variables that receive values when you call the function. When you write 'function findMax(arr)', the 'arr' is a parameter - it's a placeholder that will receive an actual array when you call the function.\n\nWhen you call 'findMax([3, 7, 2, 9, 5])', the array [3, 7, 2, 9, 5] gets passed into the function and stored in the 'arr' parameter. Inside the function, you can use 'arr' to refer to that array.",
      "example": "function findMax(arr) {\n  // 'arr' is a parameter\n}\n\nfindMax([3, 7, 2, 9, 5]);\n// The array goes into 'arr'",
      "action": "continue",
      "next": "main-loop-check-java"
    },
    {
      "stepId": "main-loops-check-java",
      "mentorSays": "To solve this, we'll need to use a loop. Do you know what a loop is in Java?",
      "choices": [
        {
          "label": "Yes, I know loops",
          "next": "coding-start-java"
        },
        {
          "label": "No, explain loops",
          "next": "main-loops-explanation-java"
        }
      ]
    },
    {
      "stepId": "main-loops-explanation-java",
      "mentorSays": "A loop lets you repeat code multiple times. A 'for' loop in Java runs code for each item in a sequence.\n\nFor example, you can loop through an array to check each element one by one.",
      "example": "for (let i = 0; i < arr.length; i++) {\n  // Process arr[i]\n}",
      "action": "continue",
      "next": "coding-start-java"
    },
    {
      "stepId": "coding-start-java",
      "mentorSays": "Perfect! Let's implement heap sort in Java. We'll need three functions:\n1. `heapSort` - the main function\n2. `buildHeap` - builds a max heap from the array\n3. `heapify` - maintains heap property\n\nLet's start with the heapSort function.",
      "example": "public static void heap_sort(arr):\n    // Your code here\n",
      "action": "continue",
      "next": "coding-build-heap-java"
    },
    {
      "stepId": "coding-build-heap-java",
      "mentorSays": "First, let's build a max heap. Start from the last parent node and heapify upwards.",
      "example": "public static void heap_sort(arr):\n    n = length(arr)\n    \n    // Build max heap\n    build_heap(arr, n)",
      "action": "continue",
      "next": "coding-extract-loop-java"
    },
    {
      "stepId": "coding-extract-loop-java",
      "mentorSays": "Now, extract the maximum element one by one. Swap root with the last element, reduce heap size, and heapify the root.",
      "example": "public static void heap_sort(arr):\n    n = length(arr)\n    build_heap(arr, n)\n    \n    // Extract elements one by one\n    for (int i = n - 1; i > 0; i--) {\n        int temp = arr[0]; arr[0] = arr[i]; arr[i] = temp\n        heapify(arr, i, 0)",
      "action": "continue",
      "next": "coding-build-heap-impl-java"
    },
    {
      "stepId": "coding-build-heap-impl-java",
      "mentorSays": "Now let's implement buildHeap. Start from the last parent and heapify each node upwards.",
      "example": "public static void build_heap(arr, n):\n    // Start from last parent node\n    for (int i = n / 2 - 1; i >= 0; i--) {\n        heapify(arr, n, i)",
      "action": "continue",
      "next": "coding-heapify-start-java"
    },
    {
      "stepId": "coding-heapify-start-java",
      "mentorSays": "Now let's implement the heapify function. This maintains the max heap property.",
      "example": "public static void heapify(arr, n, i):\n    // Your code here\n",
      "action": "continue",
      "next": "coding-heapify-find-children-java"
    },
    {
      "stepId": "coding-heapify-find-children-java",
      "mentorSays": "Find the indices of the left and right children of node i.",
      "example": "public static void heapify(arr, n, i):\n    int largest = i  // Initialize largest as root\n    int left = 2 * i + 1  // Left child\n    int right = 2 * i + 2  // Right child",
      "action": "continue",
      "next": "coding-heapify-compare-java"
    },
    {
      "stepId": "coding-heapify-compare-java",
      "mentorSays": "Compare the root with left and right children. If a child is larger, mark it as the largest.",
      "example": "public static void heapify(arr, n, i):\n    int largest = i\n    int left = 2 * i + 1\n    int right = 2 * i + 2\n    \n    // Compare with left child\n    if (left < n && arr[left] > arr[largest]) {\n        largest = left\n    \n    // Compare with right child\n    if (right < n && arr[right] > arr[largest]) {\n        largest = right",
      "action": "continue",
      "next": "coding-heapify-swap-java"
    },
    {
      "stepId": "coding-heapify-swap-java",
      "mentorSays": "If the largest is not the root, swap and recursively heapify the affected subtree.",
      "example": "public static void heapify(arr, n, i):\n    int largest = i\n    int left = 2 * i + 1\n    int right = 2 * i + 2\n    \n    if (left < n && arr[left] > arr[largest]) {\n        largest = left\n    \n    if (right < n && arr[right] > arr[largest]) {\n        largest = right\n    \n    // If largest is not root, swap and heapify\n    if (largest != i) {\n        arr[i], arr[largest] = arr[largest], arr[i]\n        heapify(arr, n, largest)",
      "action": "continue",
      "next": "test-code-java"
    },
    {
      "stepId": "test-code-java",
      "mentorSays": "Perfect! Now test your code with the example we used earlier:\n\narr = [5, 2, 8, 1, 9, 3]\n\nAfter calling heap_sort(arr), the array should be:\n[1, 2, 3, 5, 8, 9]\n\nTry it in your IDE or code editor!",
      "example": "Test input:\narr = [5, 2, 8, 1, 9, 3]\n\nAfter heap_sort(arr):\narr = [1, 2, 3, 5, 8, 9]",
      "action": "continue",
      "next": "final"
    },
    {
      "stepId": "coding-start-java",
      "mentorSays": "Perfect! Let's start coding the solution in Java.",
      "action": "continue",
      "next": "main-coding-complete-java"
    },
    {
      "mentorSays": "Great! You've implemented the solution in Java. Try running it with the example input to see if it works!",
      "action": "continue",
      "next": "test-code"
    },
    {
      "stepId": "main-variables-check-cpp",
      "mentorSays": "Before we start coding, let me ask: Do you know what a variable is in C++?",
      "choices": [
        {
          "label": "Yes, I know variables",
          "next": "coding-start-cpp"
        },
        {
          "label": "No, explain variables",
          "next": "main-variables-explanation-cpp"
        }
      ]
    },
    {
      "stepId": "main-variables-explanation-cpp",
      "mentorSays": "A variable is like a labeled box where you can store a value. You give it a name (like 'arr' or 'numbers') and put data inside it.\n\nFor example, in C++, you can create a variable that stores an array. Later, you can use that variable name to refer to the array.",
      "example": "numbers = [3, 7, 2, 9, 5]\n\nNow the variable refers to the array\nWe can use the variable name to access this array",
      "action": "continue",
      "next": "main-function-check-cpp"
    },
    {
      "stepId": "main-functions-check-cpp",
      "mentorSays": "Before we start coding, let me ask: Do you know what a function is in C++?",
      "choices": [
        {
          "label": "Yes, I know functions",
          "next": "coding-start-cpp"
        },
        {
          "label": "No, explain functions",
          "next": "main-functions-explanation-cpp"
        }
      ]
    },
    {
      "stepId": "main-functions-explanation-cpp",
      "mentorSays": "A function is a reusable block of code. You give it inputs (called parameters), and it can return an output.\n\nThink of it like a recipe: you provide ingredients (parameters), the function does the work, and gives you a result (return value).",
      "example": "function add(a, b) {\n  return a + b;\n}\n\nadd(3, 5) returns 8",
      "action": "continue",
      "next": "main-parameter-check-cpp"
    },
    {
      "stepId": "main-parameters-check-cpp",
      "mentorSays": "When we write a function, we can give it inputs. These inputs are called 'parameters'. Do you know what parameters are?",
      "choices": [
        {
          "label": "Yes, I know parameters",
          "next": "coding-start-cpp"
        },
        {
          "label": "No, explain parameters",
          "next": "main-parameters-explanation-cpp"
        }
      ]
    },
    {
      "stepId": "main-parameters-explanation-cpp",
      "mentorSays": "Parameters are like variables that receive values when you call the function. When you write 'function findMax(arr)', the 'arr' is a parameter - it's a placeholder that will receive an actual array when you call the function.\n\nWhen you call 'findMax([3, 7, 2, 9, 5])', the array [3, 7, 2, 9, 5] gets passed into the function and stored in the 'arr' parameter. Inside the function, you can use 'arr' to refer to that array.",
      "example": "function findMax(arr) {\n  // 'arr' is a parameter\n}\n\nfindMax([3, 7, 2, 9, 5]);\n// The array goes into 'arr'",
      "action": "continue",
      "next": "main-loop-check-cpp"
    },
    {
      "stepId": "main-loops-check-cpp",
      "mentorSays": "To solve this, we'll need to use a loop. Do you know what a loop is in C++?",
      "choices": [
        {
          "label": "Yes, I know loops",
          "next": "coding-start-cpp"
        },
        {
          "label": "No, explain loops",
          "next": "main-loops-explanation-cpp"
        }
      ]
    },
    {
      "stepId": "main-loops-explanation-cpp",
      "mentorSays": "A loop lets you repeat code multiple times. A 'for' loop in C++ runs code for each item in a sequence.\n\nFor example, you can loop through an array to check each element one by one.",
      "example": "for (let i = 0; i < arr.length; i++) {\n  // Process arr[i]\n}",
      "action": "continue",
      "next": "coding-start-cpp"
    },
    {
      "stepId": "coding-start-cpp",
      "mentorSays": "Perfect! Let's implement heap sort in Cpp. We'll need three functions:\n1. `heapSort` - the main function\n2. `buildHeap` - builds a max heap from the array\n3. `heapify` - maintains heap property\n\nLet's start with the heapSort function.",
      "example": "void heap_sort(arr):\n    // Your code here\n",
      "action": "continue",
      "next": "coding-build-heap-cpp"
    },
    {
      "stepId": "coding-build-heap-cpp",
      "mentorSays": "First, let's build a max heap. Start from the last parent node and heapify upwards.",
      "example": "void heap_sort(arr):\n    n = size()(arr)\n    \n    // Build max heap\n    build_heap(arr, n)",
      "action": "continue",
      "next": "coding-extract-loop-cpp"
    },
    {
      "stepId": "coding-extract-loop-cpp",
      "mentorSays": "Now, extract the maximum element one by one. Swap root with the last element, reduce heap size, and heapify the root.",
      "example": "void heap_sort(arr):\n    n = size()(arr)\n    build_heap(arr, n)\n    \n    // Extract elements one by one\n    for (int i = n - 1; i > 0; i--) {\n        swap(arr[0], arr[i])\n        heapify(arr, i, 0)",
      "action": "continue",
      "next": "coding-build-heap-impl-cpp"
    },
    {
      "stepId": "coding-build-heap-impl-cpp",
      "mentorSays": "Now let's implement buildHeap. Start from the last parent and heapify each node upwards.",
      "example": "void build_heap(arr, n):\n    // Start from last parent node\n    for (int i = n / 2 - 1; i >= 0; i--) {\n        heapify(arr, n, i)",
      "action": "continue",
      "next": "coding-heapify-start-cpp"
    },
    {
      "stepId": "coding-heapify-start-cpp",
      "mentorSays": "Now let's implement the heapify function. This maintains the max heap property.",
      "example": "void heapify(arr, n, i):\n    // Your code here\n",
      "action": "continue",
      "next": "coding-heapify-find-children-cpp"
    },
    {
      "stepId": "coding-heapify-find-children-cpp",
      "mentorSays": "Find the indices of the left and right children of node i.",
      "example": "void heapify(arr, n, i):\n    int largest = i  // Initialize largest as root\n    int left = 2 * i + 1  // Left child\n    int right = 2 * i + 2  // Right child",
      "action": "continue",
      "next": "coding-heapify-compare-cpp"
    },
    {
      "stepId": "coding-heapify-compare-cpp",
      "mentorSays": "Compare the root with left and right children. If a child is larger, mark it as the largest.",
      "example": "void heapify(arr, n, i):\n    int largest = i\n    int left = 2 * i + 1\n    int right = 2 * i + 2\n    \n    // Compare with left child\n    if (left < n && arr[left] > arr[largest]) {\n        largest = left\n    \n    // Compare with right child\n    if (right < n && arr[right] > arr[largest]) {\n        largest = right",
      "action": "continue",
      "next": "coding-heapify-swap-cpp"
    },
    {
      "stepId": "coding-heapify-swap-cpp",
      "mentorSays": "If the largest is not the root, swap and recursively heapify the affected subtree.",
      "example": "void heapify(arr, n, i):\n    int largest = i\n    int left = 2 * i + 1\n    int right = 2 * i + 2\n    \n    if (left < n && arr[left] > arr[largest]) {\n        largest = left\n    \n    if (right < n && arr[right] > arr[largest]) {\n        largest = right\n    \n    // If largest is not root, swap and heapify\n    if (largest != i) {\n        arr[i], arr[largest] = arr[largest], arr[i]\n        heapify(arr, n, largest)",
      "action": "continue",
      "next": "test-code-cpp"
    },
    {
      "stepId": "test-code-cpp",
      "mentorSays": "Perfect! Now test your code with the example we used earlier:\n\narr = [5, 2, 8, 1, 9, 3]\n\nAfter calling heap_sort(arr), the array should be:\n[1, 2, 3, 5, 8, 9]\n\nTry it in your IDE or code editor!",
      "example": "Test input:\narr = [5, 2, 8, 1, 9, 3]\n\nAfter heap_sort(arr):\narr = [1, 2, 3, 5, 8, 9]",
      "action": "continue",
      "next": "final"
    },
    {
      "stepId": "coding-start-cpp",
      "mentorSays": "Perfect! Let's start coding the solution in C++.",
      "action": "continue",
      "next": "main-coding-complete-cpp"
    },
    {
      "mentorSays": "Great! You've implemented the solution in C++. Try running it with the example input to see if it works!",
      "action": "continue",
      "next": "test-code"
    },
    {
      "stepId": "main-variables-check-ts",
      "mentorSays": "Before we start coding, let me ask: Do you know what a variable is in TypeScript?",
      "choices": [
        {
          "label": "Yes, I know variables",
          "next": "coding-start-ts"
        },
        {
          "label": "No, explain variables",
          "next": "main-variables-explanation-ts"
        }
      ]
    },
    {
      "stepId": "main-variables-explanation-ts",
      "mentorSays": "A variable is like a labeled box where you can store a value. You give it a name (like 'arr' or 'numbers') and put data inside it.\n\nFor example, in TypeScript, you can create a variable that stores an array. Later, you can use that variable name to refer to the array.",
      "example": "numbers = [3, 7, 2, 9, 5]\n\nNow the variable refers to the array\nWe can use the variable name to access this array",
      "action": "continue",
      "next": "main-function-check-ts"
    },
    {
      "stepId": "main-functions-check-ts",
      "mentorSays": "Before we start coding, let me ask: Do you know what a function is in TypeScript?",
      "choices": [
        {
          "label": "Yes, I know functions",
          "next": "coding-start-ts"
        },
        {
          "label": "No, explain functions",
          "next": "main-functions-explanation-ts"
        }
      ]
    },
    {
      "stepId": "main-functions-explanation-ts",
      "mentorSays": "A function is a reusable block of code. You give it inputs (called parameters), and it can return an output.\n\nThink of it like a recipe: you provide ingredients (parameters), the function does the work, and gives you a result (return value).",
      "example": "function add(a, b) {\n  return a + b;\n}\n\nadd(3, 5) returns 8",
      "action": "continue",
      "next": "main-parameter-check-ts"
    },
    {
      "stepId": "main-parameters-check-ts",
      "mentorSays": "When we write a function, we can give it inputs. These inputs are called 'parameters'. Do you know what parameters are?",
      "choices": [
        {
          "label": "Yes, I know parameters",
          "next": "coding-start-ts"
        },
        {
          "label": "No, explain parameters",
          "next": "main-parameters-explanation-ts"
        }
      ]
    },
    {
      "stepId": "main-parameters-explanation-ts",
      "mentorSays": "Parameters are like variables that receive values when you call the function. When you write 'function findMax(arr)', the 'arr' is a parameter - it's a placeholder that will receive an actual array when you call the function.\n\nWhen you call 'findMax([3, 7, 2, 9, 5])', the array [3, 7, 2, 9, 5] gets passed into the function and stored in the 'arr' parameter. Inside the function, you can use 'arr' to refer to that array.",
      "example": "function findMax(arr) {\n  // 'arr' is a parameter\n}\n\nfindMax([3, 7, 2, 9, 5]);\n// The array goes into 'arr'",
      "action": "continue",
      "next": "main-loop-check-ts"
    },
    {
      "stepId": "main-loops-check-ts",
      "mentorSays": "To solve this, we'll need to use a loop. Do you know what a loop is in TypeScript?",
      "choices": [
        {
          "label": "Yes, I know loops",
          "next": "coding-start-ts"
        },
        {
          "label": "No, explain loops",
          "next": "main-loops-explanation-ts"
        }
      ]
    },
    {
      "stepId": "main-loops-explanation-ts",
      "mentorSays": "A loop lets you repeat code multiple times. A 'for' loop in TypeScript runs code for each item in a sequence.\n\nFor example, you can loop through an array to check each element one by one.",
      "example": "for (let i = 0; i < arr.length; i++) {\n  // Process arr[i]\n}",
      "action": "continue",
      "next": "coding-start-ts"
    },
    {
      "stepId": "coding-start-ts",
      "mentorSays": "Perfect! Let's implement heap sort in TypeScript. We'll need three functions:\n1. `heapSort` - the main function\n2. `buildHeap` - builds a max heap from the array\n3. `heapify` - maintains heap property\n\nLet's start with the heapSort function.",
      "example": "function heap_sort(arr):\n    // Your code here\n",
      "action": "continue",
      "next": "coding-build-heap-ts"
    },
    {
      "stepId": "coding-build-heap-ts",
      "mentorSays": "First, let's build a max heap. Start from the last parent node and heapify upwards.",
      "example": "function heap_sort(arr):\n    n = length(arr)\n    \n    // Build max heap\n    build_heap(arr, n)",
      "action": "continue",
      "next": "coding-extract-loop-ts"
    },
    {
      "stepId": "coding-extract-loop-ts",
      "mentorSays": "Now, extract the maximum element one by one. Swap root with the last element, reduce heap size, and heapify the root.",
      "example": "function heap_sort(arr):\n    n = length(arr)\n    build_heap(arr, n)\n    \n    // Extract elements one by one\n    for (let i = n - 1; i > 0; i--) {\n        [arr[0], arr[i]] = [arr[i], arr[0]]\n        heapify(arr, i, 0)",
      "action": "continue",
      "next": "coding-build-heap-impl-ts"
    },
    {
      "stepId": "coding-build-heap-impl-ts",
      "mentorSays": "Now let's implement buildHeap. Start from the last parent and heapify each node upwards.",
      "example": "function build_heap(arr, n):\n    // Start from last parent node\n    for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {\n        heapify(arr, n, i)",
      "action": "continue",
      "next": "coding-heapify-start-ts"
    },
    {
      "stepId": "coding-heapify-start-ts",
      "mentorSays": "Now let's implement the heapify function. This maintains the max heap property.",
      "example": "function heapify(arr, n, i):\n    // Your code here\n",
      "action": "continue",
      "next": "coding-heapify-find-children-ts"
    },
    {
      "stepId": "coding-heapify-find-children-ts",
      "mentorSays": "Find the indices of the left and right children of node i.",
      "example": "function heapify(arr, n, i):\n    let largest: number = i  // Initialize largest as root\n    const left: number = 2 * i + 1  // Left child\n    const right: number = 2 * i + 2  // Right child",
      "action": "continue",
      "next": "coding-heapify-compare-ts"
    },
    {
      "stepId": "coding-heapify-compare-ts",
      "mentorSays": "Compare the root with left and right children. If a child is larger, mark it as the largest.",
      "example": "function heapify(arr, n, i):\n    let largest: number = i\n    const left: number = 2 * i + 1\n    const right: number = 2 * i + 2\n    \n    // Compare with left child\n    if (left < n && arr[left] > arr[largest]) {\n        largest = left\n    \n    // Compare with right child\n    if (right < n && arr[right] > arr[largest]) {\n        largest = right",
      "action": "continue",
      "next": "coding-heapify-swap-ts"
    },
    {
      "stepId": "coding-heapify-swap-ts",
      "mentorSays": "If the largest is not the root, swap and recursively heapify the affected subtree.",
      "example": "function heapify(arr, n, i):\n    let largest: number = i\n    const left: number = 2 * i + 1\n    const right: number = 2 * i + 2\n    \n    if (left < n && arr[left] > arr[largest]) {\n        largest = left\n    \n    if (right < n && arr[right] > arr[largest]) {\n        largest = right\n    \n    // If largest is not root, swap and heapify\n    if (largest !== i) {\n        arr[i], arr[largest] = arr[largest], arr[i]\n        heapify(arr, n, largest)",
      "action": "continue",
      "next": "test-code-ts"
    },
    {
      "stepId": "test-code-ts",
      "mentorSays": "Perfect! Now test your code with the example we used earlier:\n\narr = [5, 2, 8, 1, 9, 3]\n\nAfter calling heap_sort(arr), the array should be:\n[1, 2, 3, 5, 8, 9]\n\nTry it in your IDE or code editor!",
      "example": "Test input:\narr = [5, 2, 8, 1, 9, 3]\n\nAfter heap_sort(arr):\narr = [1, 2, 3, 5, 8, 9]",
      "action": "continue",
      "next": "final"
    },
    {
      "stepId": "final",
      "mentorSays": "ðŸŽ‰ Well done! You've learned heap sort. You understand how it builds a max heap and extracts maximums to sort the array.\n\nHeap sort has guaranteed O(n log n) time complexity in all cases, making it very reliable! Keep practicing!",
      "action": "continue"
    }
  ]
}