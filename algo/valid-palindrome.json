{
  "id": "valid-palindrome",
  "title": "Valid Palindrome",
  "pattern": "two-pointers",
  "difficulty": "easy",
  "language": "javascript",
  "status": "PERFECT",
  "standardsVersion": "lessonStandards.v1",
  "curriculum": {
    "lessonOrderTag": "FOUNDATION-06",
    "introduces": ["two-pointers-on-strings", "character-filtering"],
    "assumesAlreadyTaught": [
      "variables",
      "arrays",
      "indexes",
      "loops",
      "functions",
      "return",
      "comparison",
      "strings"
    ]
  },
  "pseudocode": [
    { "id": "ps1", "text": "Set left = 0 and right = last index of string." },
    { "id": "ps2", "text": "While left < right:" },
    { "id": "ps3", "text": "  Move left forward if it is not alphanumeric." },
    { "id": "ps4", "text": "  Move right backward if it is not alphanumeric." },
    { "id": "ps5", "text": "  If characters at left and right differ (case-insensitive), return false." },
    { "id": "ps6", "text": "  Move both pointers inward." },
    { "id": "ps7", "text": "Return true." }
  ],
  "flow": [
    {
      "stepId": "lesson-start",
      "mentorSays": "You selected **Valid Palindrome**.\n\nThis lesson practices the **two-pointer** pattern on strings.",
      "action": "next",
      "next": "problem-statement"
    },
    {
      "stepId": "problem-statement",
      "mentorSays": "### Problem\nGiven a string, determine if it is a palindrome.\n\nA palindrome reads the same forward and backward **after removing non-alphanumeric characters** and **ignoring case**.",
      "example": "s = \"A man, a plan, a canal: Panama\"",
      "action": "next",
      "next": "tiny-examples"
    },
    {
      "stepId": "tiny-examples",
      "mentorSays": "Tiny examples:\n\n1) \"racecar\" → true\n2) \"race a car\" → false",
      "action": "next",
      "next": "why-not-reverse"
    },
    {
      "stepId": "why-not-reverse",
      "mentorSays": "Reversing the string works, but it creates extra space.\n\nWe want a **single-pass**, in-place style solution.",
      "action": "next",
      "next": "thinking-challenge"
    },
    {
      "stepId": "thinking-challenge",
      "mentorSays": "Thinking challenge:\n\nIf we compare characters from both ends, how can we skip punctuation and spaces?",
      "choices": [
        { "label": "Move pointers inward until valid characters are found", "next": "core-idea" },
        { "label": "Build a new cleaned string first", "next": "core-idea" }
      ]
    },
    {
      "stepId": "core-idea",
      "mentorSays": "Correct.\n\nWe use **two pointers**:\n- one starts at the beginning\n- one at the end\n\nEach pointer skips non-alphanumeric characters.",
      "action": "next",
      "next": "data-cleaning"
    },
    {
      "stepId": "data-cleaning",
      "mentorSays": "### Data Cleaning Step (Critical!)\n\n**Before using two pointers, we need to normalize the input:**\n\n1. **Convert to lowercase** - \"A\" and \"a\" should be treated the same\n2. **Remove non-alphanumeric characters** - Only keep letters and numbers\n\n**JavaScript example:**\n```javascript\ns = s.toLowerCase().replace(/[^a-z0-9]/g, '');\n```\n\n**What this does:**\n- `toLowerCase()` - Makes all characters lowercase\n- `replace(/[^a-z0-9]/g, '')` - Removes everything that's NOT a-z or 0-9\n\n**Example:**\n```\n\"A man, a plan, a canal: Panama\"\n→ \"amanaplanacanalpanama\"\n```\n\n**Why this matters:** Without cleaning, you'll get wrong answers on LeetCode! Punctuation and spaces must be removed.",
      "action": "next",
      "next": "two-pointers-explained"
    },
    {
      "stepId": "two-pointers-explained",
      "mentorSays": "### Two pointers on a string\n\nAt each step:\n- move left until it points to a valid character\n- move right until it points to a valid character\n- compare the two",
      "action": "next",
      "next": "walkthrough-mini"
    },
    {
      "stepId": "walkthrough-mini",
      "mentorSays": "Mini walkthrough:\n\n\"a!b@a\"\n\nleft → 'a'\nright → 'a'\n\nMove inward → 'b' vs 'b'\n\nAll matched → palindrome",
      "action": "next",
      "next": "pseudocode-step"
    },
    {
      "stepId": "pseudocode-step",
      "mentorSays": "### Pseudocode (logic plan)",
      "pseudocodeLineIds": ["ps1","ps2","ps3","ps4","ps5","ps6","ps7"],
      "action": "next",
      "next": "coding-intro"
    },
    {
      "stepId": "coding-intro",
      "mentorSays": "Now we write JavaScript.\n\nFocus on pointer movement and comparisons.",
      "action": "next",
      "next": "code-01-function",
      "pseudocodeLineIds": ["ps1"]
    },
    {
      "stepId": "code-01-function",
      "mentorSays": "Step 1: Create the function and pointers.",
      "example": "function isPalindrome(s) {\n  let left = 0;\n  let right = s.length - 1;\n\n}",
      "action": "next",
      "next": "code-02-loop",
      "pseudocodeLineIds": ["ps2"]
    },
    {
      "stepId": "code-02-loop",
      "mentorSays": "Step 2: Loop while pointers have not crossed.",
      "example": "while (left < right) {\n\n}",
      "action": "next",
      "next": "code-03-skip",
      "pseudocodeLineIds": ["ps3","ps4"]
    },
    {
      "stepId": "code-03-skip",
      "mentorSays": "Step 3: Skip non-alphanumeric characters.",
      "example": "while (left < right && !isAlphaNumeric(s[left])) left++;\nwhile (left < right && !isAlphaNumeric(s[right])) right--;",
      "action": "next",
      "next": "code-04-compare",
      "pseudocodeLineIds": ["ps5","ps6"]
    },
    {
      "stepId": "code-04-compare",
      "mentorSays": "Step 4: Compare characters and move inward.",
      "example": "if (s[left].toLowerCase() !== s[right].toLowerCase()) return false;\nleft++;\nright--;",
      "action": "next",
      "next": "final-code"
    },
    {
      "stepId": "final-code",
      "mentorSays": "### Final JavaScript code",
      "example": "function isPalindrome(s) {\n  let left = 0;\n  let right = s.length - 1;\n\n  const isAlphaNumeric = (ch) => /[a-z0-9]/i.test(ch);\n\n  while (left < right) {\n    while (left < right && !isAlphaNumeric(s[left])) left++;\n    while (left < right && !isAlphaNumeric(s[right])) right--;\n\n    if (s[left].toLowerCase() !== s[right].toLowerCase()) return false;\n\n    left++;\n    right--;\n  }\n\n  return true;\n}",
      "action": "next",
      "next": "wrap-up"
    },
    {
      "stepId": "common-mistakes",
      "mentorSays": "### Common Mistakes\n\n1. **Forgetting to clean input** - Not removing punctuation/spaces causes wrong answers\n2. **Case sensitivity** - \"A\" != \"a\" unless you convert to lowercase\n3. **Regex pattern errors** - Use `/[^a-z0-9]/g` not `/[a-z0-9]/g` (the ^ means \"not\")\n4. **Pointer movement order** - Must skip non-alphanumeric BEFORE comparing\n5. **Empty string after cleaning** - Edge case: empty string is a palindrome",
      "action": "next",
      "next": "interview-talk-track"
    },
    {
      "stepId": "interview-talk-track",
      "mentorSays": "### Interview Talk Track (30 seconds)\n\n**How to explain this solution in an interview:**\n\n1. **\"First, I normalize the string by converting to lowercase and removing non-alphanumeric characters\"**\n2. **\"Then I use two pointers starting from both ends\"**\n3. **\"I skip any non-alphanumeric characters by moving pointers inward\"**\n4. **\"I compare characters at both pointers - if they don't match, it's not a palindrome\"**\n5. **\"This gives us O(n) time complexity with O(1) space if we clean in-place, or O(n) space if we create a new string\"**",
      "action": "next",
      "next": "wrap-up"
    },
    {
      "stepId": "wrap-up",
      "mentorSays": "Wrap-up:\n\nYou practiced:\n- two pointers on strings\n- skipping unwanted characters\n- case-insensitive comparison\n- data cleaning and normalization\n\nThis pattern applies to many string-validation problems.\n\n**Follow-up variant:**\n\n**Valid Palindrome II:** Can you remove at most one character to make it a palindrome? How would you modify the two-pointer approach?",
      "action": "complete"
    }
  ]
}
