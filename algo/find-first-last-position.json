{
  "id": "find-first-last-position",
  "title": "Find First and Last Position",
  "pattern": "binary-search",
  "difficulty": "medium",
  "language": "javascript",
  "status": "draft",
  "flow": [
    {
      "stepId": "objectives",
      "mentorSays": "Hey! Welcome to the Find First and Last Position lesson.\n\nIn this lesson, you'll learn a problem-solving pattern that shows up in coding interviews.\n\nAfter this, you'll be able to:\n- Understand the Find First and Last Position problem\n- Recognize the binary-search pattern\n- Build a complete solution step-by-step\n\nLet's dive in!",
      "action": "continue",
      "next": "language-selection"
    },
    {
      "stepId": "language-selection",
      "mentorSays": "Before we dive into the problem, which programming language would you like to use?\n\nThis will help me make sure you have the right building blocks.",
      "choices": [
        {
          "label": "JavaScript",
          "next": "prereq-check-js"
        },
        {
          "label": "Python",
          "next": "prereq-check-python"
        },
        {
          "label": "Java",
          "next": "prereq-check-java"
        },
        {
          "label": "C++",
          "next": "prereq-check-cpp"
        },
        {
          "label": "TypeScript",
          "next": "prereq-check-ts"
        }
      ]
    },
    {
      "stepId": "prereq-check-js",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in JavaScript, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-js"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-js"
        }
      ]
    },
    {
      "stepId": "prereq-check-python",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in Python, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-python"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-python"
        }
      ]
    },
    {
      "stepId": "prereq-check-java",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in Java, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-java"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-java"
        }
      ]
    },
    {
      "stepId": "prereq-check-cpp",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in C++, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-cpp"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-cpp"
        }
      ]
    },
    {
      "stepId": "prereq-check-ts",
      "mentorSays": "Great choice! Before we start, let me make sure you have the building blocks.\n\nTo solve this problem in TypeScript, you'll need to know:\n- **Arrays** - How to store and access lists of values\n- **Loops** - How to iterate through data\n- **Conditionals** - How to make decisions in code\n\nDo you feel confident with these concepts?",
      "choices": [
        {
          "label": "Yes, I know them all",
          "next": "problem-understanding"
        },
        {
          "label": "No, please explain them",
          "next": "teach-prereqs-ts"
        },
        {
          "label": "I know some, not all",
          "next": "select-prereqs-ts"
        }
      ]
    },
    {
      "stepId": "teach-all-prereqs-js",
      "mentorSays": "Great! Let me teach you the JavaScript concepts you'll need.",
      "action": "continue",
      "next": "function-check-js"
    },
    {
      "stepId": "function-check-js",
      "mentorSays": "Before we start coding, let me ask: Do you know what a function is in JavaScript?",
      "example": "",
      "action": "continue",
      "next": "completion"
    },
    {
      "stepId": "function-explanation-js",
      "mentorSays": "A function is a reusable block of code. You give it inputs (called parameters), and it can return an output.\n\nThink of it like a recipe: you provide ingredients (parameters), the function does the work, and gives you a result (return value).",
      "example": "function add(a, b) {\n  return a + b;\n}\n\nadd(3, 5) returns 8\nadd(10, 20) returns 30",
      "action": "continue",
      "next": "completion"
    },
    {
      "stepId": "loop-check-js",
      "mentorSays": "To solve this problem, we'll need to use loops. Do you know what a loop is in JavaScript?",
      "example": "",
      "action": "continue",
      "next": "completion"
    },
    {
      "stepId": "loop-explanation-js",
      "mentorSays": "A loop lets you repeat code multiple times. A 'while' loop runs code while a condition is true.\n\nFor example, 'while (left <= right)' means: keep going while left is less than or equal to right.",
      "example": "while (left <= right) {\n    // This code runs while the condition is true\n    // We'll do binary search here\n}",
      "action": "continue",
      "next": "coding-start-js"
    },
    {
      "stepId": "teach-all-prereqs-python",
      "mentorSays": "Let me explain the Python concepts you'll need.\n\n[Prerequisite teaching will be expanded in Phase 2]\n\nFor now, let's continue to the problem!",
      "action": "continue",
      "next": "problem-understanding"
    },
    {
      "stepId": "teach-all-prereqs-java",
      "mentorSays": "Let me explain the Java concepts you'll need.\n\n[Prerequisite teaching will be expanded in Phase 2]\n\nFor now, let's continue to the problem!",
      "action": "continue",
      "next": "problem-understanding"
    },
    {
      "stepId": "teach-all-prereqs-cpp",
      "mentorSays": "Let me explain the C++ concepts you'll need.\n\n[Prerequisite teaching will be expanded in Phase 2]\n\nFor now, let's continue to the problem!",
      "action": "continue",
      "next": "problem-understanding"
    },
    {
      "stepId": "teach-all-prereqs-ts",
      "mentorSays": "Let me explain the TypeScript concepts you'll need.\n\n[Prerequisite teaching will be expanded in Phase 2]\n\nFor now, let's continue to the problem!",
      "action": "continue",
      "next": "problem-understanding"
    },
    {
      "stepId": "problem-understanding",
      "mentorSays": "At the end of this lesson, you will be able to:\n\n1. Understand what the Find First and Last Position problem asks for\n2. Use two binary searches to find the first and last occurrence\n3. Modify binary search to find leftmost and rightmost positions\n4. Handle edge cases like target not found or single occurrence\n5. Implement the solution step by step in your chosen language",
      "example": null,
      "action": "continue",
      "next": "approach-exploration"
    },
    {
      "stepId": "thinking-challenge",
      "mentorSays": "Now that you understand the problem, how would YOU approach solving it?\n\nThink about it for a moment.",
      "choices": [
        {
          "label": "Check every possibility",
          "next": "explore-brute-force"
        },
        {
          "label": "Use a smarter approach",
          "next": "explore-optimal"
        },
        {
          "label": "I'm not sure, show me",
          "next": "explore-optimal"
        }
      ]
    },
    {
      "stepId": "explore-solution",
      "mentorSays": "Let me show you the optimal approach for this problem. [Strategy will be extracted from original lesson]",
      "action": "continue",
      "next": "solution-finalized"
    },
    {
      "stepId": "approach-exploration",
      "mentorSays": "Now that you understand the problem, let's think about how to solve it.\n\nWhat approach feels natural to you?",
      "choices": [
        {
          "label": "Try the straightforward approach first",
          "next": "explore-solution"
        },
        {
          "label": "Show me the optimal solution",
          "next": "explore-solution"
        }
      ]
    },
    {
      "stepId": "explore-brute-force",
      "mentorSays": "The brute force approach would check every possibility.\n\nThis works but is usually slow (O(n squared) or worse).\n\nLet's look at a smarter approach!",
      "action": "continue",
      "next": "explore-optimal"
    },
    {
      "stepId": "explore-optimal",
      "mentorSays": "The optimal approach uses a smarter strategy to avoid unnecessary work.\n\n[Strategy details will be added in Phase 2]",
      "action": "continue",
      "next": "solution-finalized"
    },
    {
      "stepId": "solution-finalized",
      "mentorSays": "Perfect! We've explored the approach. Now let's code the optimal solution.\n\nReady to write some code?",
      "action": "continue",
      "next": "coding-start-js"
    },
    {
      "stepId": "coding-start-js",
      "mentorSays": "Perfect! Let's implement the find first and last position solution in JavaScript. We'll create a function that takes a sorted array and target, and returns [first, last] positions.",
      "example": "function searchRange(nums, target) {\n  \n}",
      "action": "continue",
      "next": "coding-find-first-init-js"
    },
    {
      "stepId": "coding-find-first-init-js",
      "mentorSays": "Create a helper function to find the first position. Initialize the binary search variables: left at 0, right at the end, and first at -1 (meaning not found yet).",
      "example": "function searchRange(nums, target) {\n  // Helper to find first (leftmost) position\n  function findFirst() {\n    let left = 0;\n    let right = nums.length - 1;\n    let first = -1;  // -1 means not found\n    \n    // Binary search will go here\n  }\n}",
      "action": "continue",
      "next": "coding-find-first-loop-js"
    },
    {
      "stepId": "coding-find-first-loop-js",
      "mentorSays": "Add the binary search while loop. While left and right don't cross, calculate the middle index.",
      "example": "function searchRange(nums, target) {\n  function findFirst() {\n    let left = 0;\n    let right = nums.length - 1;\n    let first = -1;\n    \n    while (left <= right) {\n      let mid = Math.floor((left + right) / 2);\n      \n      // Comparison logic will go here\n    }\n    \n    return first;\n  }\n}",
      "action": "continue",
      "next": "coding-find-first-compare-js"
    },
    {
      "stepId": "coding-find-first-compare-js",
      "mentorSays": "Add the comparison logic. When we find the target, save the position but continue searching LEFT to find the FIRST occurrence.",
      "example": "function searchRange(nums, target) {\n  function findFirst() {\n    let left = 0;\n    let right = nums.length - 1;\n    let first = -1;\n    \n    while (left <= right) {\n      let mid = Math.floor((left + right) / 2);\n      \n      if (nums[mid] === target) {\n        first = mid;  // Found it!\n        right = mid - 1;  // Keep searching LEFT for first occurrence\n      } else if (nums[mid] < target) {\n        left = mid + 1;\n      } else {\n        right = mid - 1;\n      }\n    }\n    \n    return first;\n  }\n}",
      "action": "continue",
      "next": "coding-find-last-init-js"
    },
    {
      "stepId": "coding-find-last-init-js",
      "mentorSays": "Now create a second helper function to find the last position. Initialize the same binary search variables.",
      "example": "function searchRange(nums, target) {\n  function findFirst() {\n    let left = 0;\n    let right = nums.length - 1;\n    let first = -1;\n    \n    while (left <= right) {\n      let mid = Math.floor((left + right) / 2);\n      if (nums[mid] === target) {\n        first = mid;\n        right = mid - 1;\n      } else if (nums[mid] < target) {\n        left = mid + 1;\n      } else {\n        right = mid - 1;\n      }\n    }\n    return first;\n  }\n  \n  // Helper to find last (rightmost) position\n  function findLast() {\n    let left = 0;\n    let right = nums.length - 1;\n    let last = -1;\n    \n    // Binary search will go here\n  }\n}",
      "action": "continue",
      "next": "coding-find-last-loop-js"
    },
    {
      "stepId": "coding-find-last-loop-js",
      "mentorSays": "Add the binary search while loop for finding the last position.",
      "example": "function searchRange(nums, target) {\n  function findFirst() {\n    let left = 0;\n    let right = nums.length - 1;\n    let first = -1;\n    while (left <= right) {\n      let mid = Math.floor((left + right) / 2);\n      if (nums[mid] === target) {\n        first = mid;\n        right = mid - 1;\n      } else if (nums[mid] < target) {\n        left = mid + 1;\n      } else {\n        right = mid - 1;\n      }\n    }\n    return first;\n  }\n  \n  function findLast() {\n    let left = 0;\n    let right = nums.length - 1;\n    let last = -1;\n    \n    while (left <= right) {\n      let mid = Math.floor((left + right) / 2);\n      \n      // Comparison logic will go here\n    }\n    \n    return last;\n  }\n}",
      "action": "continue",
      "next": "coding-find-last-compare-js"
    },
    {
      "stepId": "coding-find-last-compare-js",
      "mentorSays": "Add the comparison logic for finding last. When we find the target, continue searching RIGHT to find the LAST occurrence.",
      "example": "function searchRange(nums, target) {\n  function findFirst() {\n    let left = 0;\n    let right = nums.length - 1;\n    let first = -1;\n    while (left <= right) {\n      let mid = Math.floor((left + right) / 2);\n      if (nums[mid] === target) {\n        first = mid;\n        right = mid - 1;\n      } else if (nums[mid] < target) {\n        left = mid + 1;\n      } else {\n        right = mid - 1;\n      }\n    }\n    return first;\n  }\n  \n  function findLast() {\n    let left = 0;\n    let right = nums.length - 1;\n    let last = -1;\n    \n    while (left <= right) {\n      let mid = Math.floor((left + right) / 2);\n      \n      if (nums[mid] === target) {\n        last = mid;  // Found it!\n        left = mid + 1;  // Keep searching RIGHT for last occurrence\n      } else if (nums[mid] < target) {\n        left = mid + 1;\n      } else {\n        right = mid - 1;\n      }\n    }\n    \n    return last;\n  }\n}",
      "action": "continue",
      "next": "coding-call-helpers-js"
    },
    {
      "stepId": "coding-call-helpers-js",
      "mentorSays": "Finally, call both helper functions to get the first and last positions, then return them as an array. If the target wasn't found (first is -1), return [-1, -1].",
      "example": "function searchRange(nums, target) {\n  function findFirst() {\n    let left = 0;\n    let right = nums.length - 1;\n    let first = -1;\n    while (left <= right) {\n      let mid = Math.floor((left + right) / 2);\n      if (nums[mid] === target) {\n        first = mid;\n        right = mid - 1;\n      } else if (nums[mid] < target) {\n        left = mid + 1;\n      } else {\n        right = mid - 1;\n      }\n    }\n    return first;\n  }\n  \n  function findLast() {\n    let left = 0;\n    let right = nums.length - 1;\n    let last = -1;\n    while (left <= right) {\n      let mid = Math.floor((left + right) / 2);\n      if (nums[mid] === target) {\n        last = mid;\n        left = mid + 1;\n      } else if (nums[mid] < target) {\n        left = mid + 1;\n      } else {\n        right = mid - 1;\n      }\n    }\n    return last;\n  }\n  \n  // Find both positions\n  let first = findFirst();\n  let last = findLast();\n  \n  // If target not found, return [-1, -1]\n  if (first === -1) {\n    return [-1, -1];\n  }\n  \n  return [first, last];\n}",
      "action": "continue",
      "next": "completion"
    },
    {
      "stepId": "completion",
      "mentorSays": "ðŸŽ‰ **Congratulations!** You just solved Find First and Last Position!\n\n**What you've mastered:**\nâœ“ Understanding the problem requirements\nâœ“ Choosing an efficient approach\nâœ“ Building a complete solution from scratch\n\nYou're now ready to tackle more algorithms. Keep going! ðŸš€",
      "action": "complete"
    }
  ],
  "migrated": true,
  "migration_version": "5.0-light-touch",
  "migration_date": "2025-12-30"
}